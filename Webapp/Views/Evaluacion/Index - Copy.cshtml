@model Webapp.Controllers.InicioModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<div id="app">
	<!-- ======= Breadcrumbs ======= -->
	<section id="breadcrumbs" class="breadcrumbs">
		<div class="container">
			<ol>
				<li><a href="@Url.Content("~/")">Inicio</a></li>
				<li>Evaluación</li>
			</ol>
		</div>
	</section><!-- End Breadcrumbs -->
	<!-- ======= Contact Section ======= -->
	<section id="contact" class="contact">
		<div class="container" data-aos="fade-up">

			<div class="section-title">
				<h2>Evaluación de Detección de Phishing</h2>
			</div>

			<div class="row">

				<div class="col-lg-6 d-flex align-items-stretch">


					<form id="formLogin" role="form" class="php-email-form" autocomplete="off">

						<h4 class="text-center">Ingreso</h4>

						<p class="text-center small">
							Si tiene ya una cuenta con PhishingDetection por favor ingrese
							sus credenciales en la parte inferior
						</p>
						
						<div class="container">
							<div class="row">
								<div class="form-group col-md-8 offset-sm-2">
									<label for="">Email</label>
									<input type="email" class="form-control" placeholder="nombre@ejemplpo.com">
								</div>
							</div>

							<div class="row">
								<div class="form-group col-md-8 offset-sm-2">
									<label for="floatingPassword">Contraseña</label>
									<input type="password" class="form-control" id="floatingPassword" placeholder="Contraseña">
								</div>
							</div>

							<div class="text-center">
								<button type="submit" class="btn btn-primary btn-sm">
									Ingresar
								</button>

								<br />
								<br />

								<a href="#">Olvidó su contraseña?</a>
							</div>
						</div>
						

					</form>
				</div>

				<div class="col-lg-6 mt-5 mt-lg-0 d-flex align-items-stretch">
					<form action="" method="post" role="form" class="php-email-form" id="formRegistro">

						<div class="text-center">
							<h4>Evaluación directa</h4>
						</div>

						<div class="row">
							<div class="form-group col-md-6">
								<label for="">Nombre</label>
								<input type="text" class="form-control input-sm" v-autoname required v-model="registro.nombre">
							</div>
							<div class="form-group col-md-6">
								<label for="">Apellido</label>
								<input class="form-control input-sm" v-autoname required v-model="registro.apellido">
							</div>
						</div>

						<div class="row">
							<div class="form-group col-md-6">
								<label for="">Género</label>
								<select asp-items="Model.Generos" v-model="registro.genero" v-autoname
										class="form-select input-sm"></select>
							</div>
							<div class="form-group col-md-6">
								<label for="">Ocupación</label>
								<select asp-items="Model.Ocupaciones" v-model="registro.ocupacion" v-autoname
										class="form-select input-sm"></select>
							</div>
						</div>

						<div class="row">
							<div class="form-group col-md-6">
								<label for="">Edad</label>
								<input class="form-control input-sm" v-autoname v-model="registro.edad" maxlength="2">
							</div>
							<div class="form-group col-md-6">
								<label for="">Actividad</label>
								<select asp-items="Model.Actividades" v-model="registro.actividad" v-autoname
										class="form-select input-sm"></select>
							</div>
						</div>

						<div class="form-group">
							<label for="">Años de experiencia en cyber-seguridad</label>
							<select asp-items="Model.Anios" v-model="registro.experienciaSeguridad" v-autoname
									class="form-select input-sm"></select>
						</div>

						<div class="form-group">
							<label for="">Correo electrónico</label>
							<input type="email" class="form-control input-sm" v-autoname maxlength="100" v-model="registro.email">
						</div>

						<div class="text-center">
							<p>La información ingresada es 100% confidencial</p>
						</div>

						<div class="my-3">
							<div class="loading">Loading</div>
							<div class="error-message"></div>
							<div class="sent-message">Your message has been sent. Thank you!</div>
						</div>
						<div class="text-center">
							<button type="submit">Comenzar Evaluación</button>
						</div>
					</form>
				</div>

			</div>

		</div>
	</section><!-- End Contact Section -->
</div>

@section Scripts {
	@await Html.PartialAsync("_Validation")

	<script>

		Vue.createApp({
			data() {
				return {
					registro: @Html.Raw(ViewBag.registro),
					baseUrl: '@ViewBag.self'
				}
			},
			methods: {
				registrar() {
					var m = this.registro;
					jsonPost(this.baseUrl + '/registrar', m).then(r => {
						if (r.error)
							return alert(r.error);
						window.location.href = r.url;
					});
					return false;
				},
			},
			mounted() {
				var self = this;
				$('#formRegistro').validate({
					submitHandler: this.registrar
				});
				$('#formLogin').validate({
					submitHandler: ()=> { return false; }
				});
			}
		})
		.use(globalDirectives)
		.mount('#app')

	</script>
}